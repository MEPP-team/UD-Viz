<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link type="text/css" rel="stylesheet" href="custom.css"><title>Source: Component/Itowns/3DTiles/3DTilesUtils.js</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="",baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body class="dark" data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz/browser</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="mra33q2MTNxKVtoe6vYlU"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="$3DTemporalBatchTable.html">$3DTemporalBatchTable</a></div><div class="sidebar-section-children"><a href="$3DTemporalBoundingVolume.html">$3DTemporalBoundingVolume</a></div><div class="sidebar-section-children"><a href="$3DTemporalExtension.html">$3DTemporalExtension</a></div><div class="sidebar-section-children"><a href="$3DTemporalPrimaryTransaction.html">$3DTemporalPrimaryTransaction</a></div><div class="sidebar-section-children"><a href="$3DTemporalTileset.html">$3DTemporalTileset</a></div><div class="sidebar-section-children"><a href="$3DTemporalTransaction.html">$3DTemporalTransaction</a></div><div class="sidebar-section-children"><a href="$3DTemporalTransactionAggregate.html">$3DTemporalTransactionAggregate</a></div><div class="sidebar-section-children"><a href="$3DTemporalVersion.html">$3DTemporalVersion</a></div><div class="sidebar-section-children"><a href="AboutWindow.html">AboutWindow</a></div><div class="sidebar-section-children"><a href="AbstractDocumentWindow.html">AbstractDocumentWindow</a></div><div class="sidebar-section-children"><a href="AllWidget.html">AllWidget</a></div><div class="sidebar-section-children"><a href="AssetManager.html">AssetManager</a></div><div class="sidebar-section-children"><a href="AttributeFilter.html">AttributeFilter</a></div><div class="sidebar-section-children"><a href="AttributeFilterSelector.html">AttributeFilterSelector</a></div><div class="sidebar-section-children"><a href="AudioController.html">AudioController</a></div><div class="sidebar-section-children"><a href="AuthenticationView.html">AuthenticationView</a></div><div class="sidebar-section-children"><a href="BaseMap.html">BaseMap</a></div><div class="sidebar-section-children"><a href="Billboard.html">Billboard</a></div><div class="sidebar-section-children"><a href="CameraPositionerView.html">CameraPositionerView</a></div><div class="sidebar-section-children"><a href="Cameraman.html">Cameraman</a></div><div class="sidebar-section-children"><a href="CityObject.html">CityObject</a></div><div class="sidebar-section-children"><a href="CityObjectFilter.html">CityObjectFilter</a></div><div class="sidebar-section-children"><a href="CityObjectFilterSelector.html">CityObjectFilterSelector</a></div><div class="sidebar-section-children"><a href="CityObjectFilterWindow.html">CityObjectFilterWindow</a></div><div class="sidebar-section-children"><a href="CityObjectID.html">CityObjectID</a></div><div class="sidebar-section-children"><a href="CityObjectLayer.html">CityObjectLayer</a></div><div class="sidebar-section-children"><a href="CityObjectLinkInterface.html">CityObjectLinkInterface</a></div><div class="sidebar-section-children"><a href="CityObjectModule.html">CityObjectModule</a></div><div class="sidebar-section-children"><a href="CityObjectProvider.html">CityObjectProvider</a></div><div class="sidebar-section-children"><a href="CityObjectStyle.html">CityObjectStyle</a></div><div class="sidebar-section-children"><a href="CityObjectWindow.html">CityObjectWindow</a></div><div class="sidebar-section-children"><a href="CommandController.html">CommandController</a></div><div class="sidebar-section-children"><a href="Context.html">Context</a></div><div class="sidebar-section-children"><a href="ContributeModule.html">ContributeModule</a></div><div class="sidebar-section-children"><a href="ContributeService.html">ContributeService</a></div><div class="sidebar-section-children"><a href="Debug3DTilesWindow.html">Debug3DTilesWindow</a></div><div class="sidebar-section-children"><a href="DefaultDocumentSource.html">DefaultDocumentSource</a></div><div class="sidebar-section-children"><a href="Document.html">Document</a></div><div class="sidebar-section-children"><a href="DocumentCommentsModule.html">DocumentCommentsModule</a></div><div class="sidebar-section-children"><a href="DocumentCommentsService.html">DocumentCommentsService</a></div><div class="sidebar-section-children"><a href="DocumentCommentsWindow.html">DocumentCommentsWindow</a></div><div class="sidebar-section-children"><a href="DocumentCreationWindow.html">DocumentCreationWindow</a></div><div class="sidebar-section-children"><a href="DocumentDeletionInterface.html">DocumentDeletionInterface</a></div><div class="sidebar-section-children"><a href="DocumentFilter.html">DocumentFilter</a></div><div class="sidebar-section-children"><a href="DocumentInspectorWindow.html">DocumentInspectorWindow</a></div><div class="sidebar-section-children"><a href="DocumentLinkInterface.html">DocumentLinkInterface</a></div><div class="sidebar-section-children"><a href="DocumentModule.html">DocumentModule</a></div><div class="sidebar-section-children"><a href="DocumentNavigatorWindow.html">DocumentNavigatorWindow</a></div><div class="sidebar-section-children"><a href="DocumentProvider.html">DocumentProvider</a></div><div class="sidebar-section-children"><a href="DocumentSearchFilter.html">DocumentSearchFilter</a></div><div class="sidebar-section-children"><a href="DocumentService.html">DocumentService</a></div><div class="sidebar-section-children"><a href="DocumentSource.html">DocumentSource</a></div><div class="sidebar-section-children"><a href="DocumentUpdateWindow.html">DocumentUpdateWindow</a></div><div class="sidebar-section-children"><a href="DocumentValidationModule.html">DocumentValidationModule</a></div><div class="sidebar-section-children"><a href="DocumentView.html">DocumentView</a></div><div class="sidebar-section-children"><a href="DocumentVisualizerWindow.html">DocumentVisualizerWindow</a></div><div class="sidebar-section-children"><a href="DocumentsInValidationDocumentSource.html">DocumentsInValidationDocumentSource</a></div><div class="sidebar-section-children"><a href="DragAndDropAvatar.html">DragAndDropAvatar</a></div><div class="sidebar-section-children"><a href="ExternalScriptBase_ExternalScriptBase.html">ExternalScriptBase</a></div><div class="sidebar-section-children"><a href="FocusGameObject_FocusGameObject.html">FocusGameObject</a></div><div class="sidebar-section-children"><a href="Frame3DBase.html">Frame3DBase</a></div><div class="sidebar-section-children"><a href="Frame3DPlanar.html">Frame3DPlanar</a></div><div class="sidebar-section-children"><a href="GeocodingService_GeocodingService.html">GeocodingService</a></div><div class="sidebar-section-children"><a href="GeocodingView_GeocodingView.html">GeocodingView</a></div><div class="sidebar-section-children"><a href="Graph_Graph.html">Graph</a></div><div class="sidebar-section-children"><a href="GuidedTour.html">GuidedTour</a></div><div class="sidebar-section-children"><a href="GuidedTourController.html">GuidedTourController</a></div><div class="sidebar-section-children"><a href="HelpWindow.html">HelpWindow</a></div><div class="sidebar-section-children"><a href="InputManager.html">InputManager</a></div><div class="sidebar-section-children"><a href="LayerChoice_LayerChoice.html">LayerChoice</a></div><div class="sidebar-section-children"><a href="LayerManager.html">LayerManager</a></div><div class="sidebar-section-children"><a href="Link.html">Link</a></div><div class="sidebar-section-children"><a href="LinkCountFilter.html">LinkCountFilter</a></div><div class="sidebar-section-children"><a href="LinkCountFilterSelector.html">LinkCountFilterSelector</a></div><div class="sidebar-section-children"><a href="LinkModule.html">LinkModule</a></div><div class="sidebar-section-children"><a href="LinkProvider.html">LinkProvider</a></div><div class="sidebar-section-children"><a href="LinkService.html">LinkService</a></div><div class="sidebar-section-children"><a href="LinkView.html">LinkView</a></div><div class="sidebar-section-children"><a href="LinkedWithDisplayedDocumentFilter.html">LinkedWithDisplayedDocumentFilter</a></div><div class="sidebar-section-children"><a href="LinkedWithFilteredDocumentsFilter.html">LinkedWithFilteredDocumentsFilter</a></div><div class="sidebar-section-children"><a href="LoadingView.html">LoadingView</a></div><div class="sidebar-section-children"><a href="MouseState.html">MouseState</a></div><div class="sidebar-section-children"><a href="NetworkManager.html">NetworkManager</a></div><div class="sidebar-section-children"><a href="PositionerWindow_PositionerWindow.html">PositionerWindow</a></div><div class="sidebar-section-children"><a href="RenderController_RenderController.html">RenderController</a></div><div class="sidebar-section-children"><a href="RenderData.html">RenderData</a></div><div class="sidebar-section-children"><a href="RequestAnimationFrameProcess_RequestAnimationFrameProcess.html">RequestAnimationFrameProcess</a></div><div class="sidebar-section-children"><a href="SinglePlayerGamePlanar.html">SinglePlayerGamePlanar</a></div><div class="sidebar-section-children"><a href="SlideShow.html">SlideShow</a></div><div class="sidebar-section-children"><a href="SocketIOWrapper.html">SocketIOWrapper</a></div><div class="sidebar-section-children"><a href="SparqlEndpointResponseProvider.html">SparqlEndpointResponseProvider</a></div><div class="sidebar-section-children"><a href="SparqlEndpointService.html">SparqlEndpointService</a></div><div class="sidebar-section-children"><a href="SparqlModule.html">SparqlModule</a></div><div class="sidebar-section-children"><a href="SparqlModuleView.html">SparqlModuleView</a></div><div class="sidebar-section-children"><a href="SparqlQueryWindow.html">SparqlQueryWindow</a></div><div class="sidebar-section-children"><a href="StyleManager.html">StyleManager</a></div><div class="sidebar-section-children"><a href="Table.html">Table</a></div><div class="sidebar-section-children"><a href="Target.html">Target</a></div><div class="sidebar-section-children"><a href="TemporalGraphWindow.html">TemporalGraphWindow</a></div><div class="sidebar-section-children"><a href="TemporalModule.html">TemporalModule</a></div><div class="sidebar-section-children"><a href="TemporalProvider.html">TemporalProvider</a></div><div class="sidebar-section-children"><a href="TemporalSliderWindow.html">TemporalSliderWindow</a></div><div class="sidebar-section-children"><a href="TemporalView.html">TemporalView</a></div><div class="sidebar-section-children"><a href="Tile.html">Tile</a></div><div class="sidebar-section-children"><a href="TilesManager.html">TilesManager</a></div><div class="sidebar-section-children"><a href="UpdateZWithElevationLayer.html">UpdateZWithElevationLayer</a></div><div class="sidebar-section-children"><a href="ValidationService.html">ValidationService</a></div><div class="sidebar-section-children"><a href="ValidationView.html">ValidationView</a></div><div class="sidebar-section-children"><a href="WidgetView.html">WidgetView</a></div><div class="sidebar-section-children"><a href="Window.html">Window</a></div><div class="sidebar-section-children"><a href="WindowExtension.html">WindowExtension</a></div><div class="sidebar-section-children"><a href="WindowManager.html">WindowManager</a></div><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns-LayerManager.html">LayerManager</a></div><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns-TilesManager.html">TilesManager</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="FXtr-pzjZBi459ISR9sj4"><div>Modules</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns.html">udvizBrowser/Itowns</a></div><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns_Component.html">udvizBrowser/Itowns/Component</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="JEdFyHWj1SpU-rjP2EmJ7"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-ArchitectureMVCTargetDesign.html">ArchitectureMVCTargetDesign</a></div><div class="sidebar-section-children"><a href="tutorial-Configuring-the-Document-model-of-an-UDV-deployment.html">Configuring-the-Document-model-of-an-UDV-deployment</a></div><div class="sidebar-section-children"><a href="tutorial-Contributing.html">Contributing</a></div><div class="sidebar-section-children"><a href="tutorial-Definitions.html">Definitions</a></div><div class="sidebar-section-children"><a href="tutorial-LocalGameTutorial.html">LocalGameTutorial</a></div><div class="sidebar-section-children"><a href="tutorial-ReleasePublish.html">ReleasePublish</a></div><div class="sidebar-section-children"><a href="tutorial-Reproducibility.html">Reproducibility</a></div><div class="sidebar-section-children"><a href="tutorial-View3D.html">View3D</a></div><div class="sidebar-section-children"><a href="tutorial-ContributeData.html">ContributeData</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="1yjpUHdYQvZgcGLsARdOE"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#ActionCB">ActionCB</a></div><div class="sidebar-section-children"><a href="global.html#AssetManagerConfig">AssetManagerConfig</a></div><div class="sidebar-section-children"><a href="global.html#AuthenticationService">AuthenticationService</a></div><div class="sidebar-section-children"><a href="global.html#BLANK_MATERIAL">BLANK_MATERIAL</a></div><div class="sidebar-section-children"><a href="global.html#CommandCallback">CommandCallback</a></div><div class="sidebar-section-children"><a href="global.html#DEFAULT_MATERIAL">DEFAULT_MATERIAL</a></div><div class="sidebar-section-children"><a href="global.html#DocumentInspectorExtension">DocumentInspectorExtension</a></div><div class="sidebar-section-children"><a href="global.html#DocumentNavigatorExtension">DocumentNavigatorExtension</a></div><div class="sidebar-section-children"><a href="global.html#DragAndDropAvatarVariables">DragAndDropAvatarVariables</a></div><div class="sidebar-section-children"><a href="global.html#EventCallback">EventCallback</a></div><div class="sidebar-section-children"><a href="global.html#FileReaderCallback">FileReaderCallback</a></div><div class="sidebar-section-children"><a href="global.html#FilterCityObjects">FilterCityObjects</a></div><div class="sidebar-section-children"><a href="global.html#FocusGameObjectVariables">FocusGameObjectVariables</a></div><div class="sidebar-section-children"><a href="global.html#Frame3DPlanarOption">Frame3DPlanarOption</a></div><div class="sidebar-section-children"><a href="global.html#MAPPING">MAPPING</a></div><div class="sidebar-section-children"><a href="global.html#MOUSE_STATE_EVENTS">MOUSE_STATE_EVENTS</a></div><div class="sidebar-section-children"><a href="global.html#Mapping">Mapping</a></div><div class="sidebar-section-children"><a href="global.html#Movement">Movement</a></div><div class="sidebar-section-children"><a href="global.html#OptionsRenderJSON">OptionsRenderJSON</a></div><div class="sidebar-section-children"><a href="global.html#RenderDataConfig">RenderDataConfig</a></div><div class="sidebar-section-children"><a href="global.html#RequestService">RequestService</a></div><div class="sidebar-section-children"><a href="global.html#SceneConfig">SceneConfig</a></div><div class="sidebar-section-children"><a href="global.html#SoundsConfig">SoundsConfig</a></div><div class="sidebar-section-children"><a href="global.html#TemporalOptions">TemporalOptions</a></div><div class="sidebar-section-children"><a href="global.html#TextureFile">TextureFile</a></div><div class="sidebar-section-children"><a href="global.html#UpdateZWithElevationLayerVariables">UpdateZWithElevationLayerVariables</a></div><div class="sidebar-section-children"><a href="global.html#add3DTilesLayers">add3DTilesLayers</a></div><div class="sidebar-section-children"><a href="global.html#addBaseMapLayer">addBaseMapLayer</a></div><div class="sidebar-section-children"><a href="global.html#addElevationLayer">addElevationLayer</a></div><div class="sidebar-section-children"><a href="global.html#addGeoJsonLayers">addGeoJsonLayers</a></div><div class="sidebar-section-children"><a href="global.html#cbAccepts">cbAccepts</a></div><div class="sidebar-section-children"><a href="global.html#cbAction">cbAction</a></div><div class="sidebar-section-children"><a href="global.html#cbInspectorOptionsExtension">cbInspectorOptionsExtension</a></div><div class="sidebar-section-children"><a href="global.html#cbMouseEvent">cbMouseEvent</a></div><div class="sidebar-section-children"><a href="global.html#cbNavigatorOptionsExtension">cbNavigatorOptionsExtension</a></div><div class="sidebar-section-children"><a href="global.html#cbSocketIO">cbSocketIO</a></div><div class="sidebar-section-children"><a href="global.html#cbTickAnimationFrame">cbTickAnimationFrame</a></div><div class="sidebar-section-children"><a href="global.html#checkParentChild">checkParentChild</a></div><div class="sidebar-section-children"><a href="global.html#colorBuilding">colorBuilding</a></div><div class="sidebar-section-children"><a href="global.html#computeRelativeElevationFromGround">computeRelativeElevationFromGround</a></div><div class="sidebar-section-children"><a href="global.html#createCityObjectID">createCityObjectID</a></div><div class="sidebar-section-children"><a href="global.html#createTileGroups">createTileGroups</a></div><div class="sidebar-section-children"><a href="global.html#createTileGroupsFromBatchIDs">createTileGroupsFromBatchIDs</a></div><div class="sidebar-section-children"><a href="global.html#defaultConfigScene">defaultConfigScene</a></div><div class="sidebar-section-children"><a href="global.html#defaultVariables">defaultVariables</a></div><div class="sidebar-section-children"><a href="global.html#defaultVariables">defaultVariables</a></div><div class="sidebar-section-children"><a href="global.html#defaultVariables">defaultVariables</a></div><div class="sidebar-section-children"><a href="global.html#dragElement">dragElement</a></div><div class="sidebar-section-children"><a href="global.html#getBatchIdFromIntersection">getBatchIdFromIntersection</a></div><div class="sidebar-section-children"><a href="global.html#getBatchTableFromTile">getBatchTableFromTile</a></div><div class="sidebar-section-children"><a href="global.html#getBuildingIdFromIntersection">getBuildingIdFromIntersection</a></div><div class="sidebar-section-children"><a href="global.html#getBuildingInfoFromBuildingId">getBuildingInfoFromBuildingId</a></div><div class="sidebar-section-children"><a href="global.html#getFirstTileIntersection">getFirstTileIntersection</a></div><div class="sidebar-section-children"><a href="global.html#getMeshesFromTile">getMeshesFromTile</a></div><div class="sidebar-section-children"><a href="global.html#getTileFromMesh">getTileFromMesh</a></div><div class="sidebar-section-children"><a href="global.html#getTileInLayer">getTileInLayer</a></div><div class="sidebar-section-children"><a href="global.html#getTileInTileset">getTileInTileset</a></div><div class="sidebar-section-children"><a href="global.html#getTilesInfo">getTilesInfo</a></div><div class="sidebar-section-children"><a href="global.html#getVerticesCentroid">getVerticesCentroid</a></div><div class="sidebar-section-children"><a href="global.html#getVisibleTileCount">getVisibleTileCount</a></div><div class="sidebar-section-children"><a href="global.html#getVisibleTiles">getVisibleTiles</a></div><div class="sidebar-section-children"><a href="global.html#predicateCB">predicateCB</a></div><div class="sidebar-section-children"><a href="global.html#removeTileVerticesColor">removeTileVerticesColor</a></div><div class="sidebar-section-children"><a href="global.html#setTileVerticesColor">setTileVerticesColor</a></div><div class="sidebar-section-children"><a href="global.html#setup3DTilesLayer">setup3DTilesLayer</a></div><div class="sidebar-section-children"><a href="global.html#tokenizeURI">tokenizeURI</a></div><div class="sidebar-section-children"><a href="global.html#updateITownsView">updateITownsView</a></div><div class="sidebar-section-children"><a href="global.html#windows">windows</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"><div class="navbar-item"><a id="Github" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome" href="../" target="">udviz</a></div><div class="navbar-item"><a id="udvizBrowser" href="../browser" target="">udvizBrowser</a></div><div class="navbar-item"><a id="udvizShared" href="../shared" target="">udvizShared</a></div><div class="navbar-item"><a id="udvizNode" href="../node" target="">udvizNode</a></div></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section id="source-page" class="source-page"><header><h1 id="title" class="has-anchor">Component_Itowns_3DTiles_3DTilesUtils.js</h1></header><article><pre class="prettyprint source lang-js"><code>import * as THREE from 'three';
import { Data } from '@ud-viz/shared';

/**
 * Search a batch table in a tile. A tile is a THREE.js 3DObject with a
 * 3-level hierarchy : Object3D > Scene > Mesh. This function searches into the
 * for the batch table (which is located in the Object3D level).
 *
 * @param {object} tile A 3DTiles tile object from THREE.js.
 * @returns {object} The batch table of the tile
 */
export function getBatchTableFromTile(tile) {
  if (tile.batchTable) {
    return tile.batchTable;
  } else if (tile.parent) {
    return getBatchTableFromTile(tile.parent);
  }
  return undefined;
}

/**
 * Gets an object batch ID from an intersection. This methods takes one of the
 * 3 points of the intersection triangle and retrieves the corresponding batch
 * ID in the intersection tile.
 *
 * @param {object} inter An intersection
 * @returns {number} The batch ID of the intersected geometry
 */
export function getBatchIdFromIntersection(inter) {
  const index = inter.face.a;
  return inter.object.geometry.attributes._BATCHID.array[index];
}

/**
 * Get the first intersection object where the target is a 3D object with
 * a batch id (a.k.a. the "Mesh" of a tile).
 *
 * @param {Array&lt;object>} intersects The array of intersections, provided by
 * itowns.View.pickObjectsAt
 * @returns {object} The first intersection of a visible tile
 */
export function getFirstTileIntersection(intersects) {
  for (const inter of intersects) {
    const tile = getTileFromMesh(inter.object);
    if (inter.object.visible &amp;&amp; tile.visible &amp;&amp; tile.content.visible) {
      return inter;
    }
  }
  return null;
}

/**
 * Retrieve all visible 3DTiles visible tiles (ie. those that are currently
 * rendered in the scene). This function recursively explores the tileset to
 * find all tiles and return them in a flattened array.
 *
 * @param {*} layer The 3DTiles layer.
 * @returns {Array&lt;object>} An array of all visible tiles
 */
export function getVisibleTiles(layer) {
  const rootTile = layer.object3d.children[0];
  const tiles = [];
  const exploreTree = (node) => {
    if (node) {
      if (node.batchTable) {
        // It's an actual tile
        tiles.push(node);
      }
      for (
        let childIndex = 0;
        childIndex &lt; node.children.length;
        childIndex++
      ) {
        const child = node.children[childIndex];
        if (child.type === 'Object3D') {
          // This child can be a tile or contain tiles so we explore it too
          exploreTree(child);
        }
      }
    }
  };
  exploreTree(rootTile);
  return tiles;
}

/**
 * Counts the number of 3DTiles tiles displayed by the view.
 *
 * @param {*} layer The 3DTiles layer.
 * @returns {number} The number of visible tiles
 */
export function getVisibleTileCount(layer) {
  return getVisibleTiles(layer).length;
}

/**
 * Finds the tile in the tileset with the specific ID.
 *
 * @param {*} rootTile The root tile of the 3DTiles tileset.
 * @param {*} tileId The tile id.
 * @returns {object} A 3DTiles tile object from THREE.js.
 */
export function getTileInTileset(rootTile, tileId) {
  let i = 0;
  let tile;
  if (rootTile.tileId === tileId) return rootTile;
  else if ('tileId' in rootTile &amp;&amp; tileId != 0) {
    while (!tile &amp;&amp; i &lt; rootTile.children.length) {
      tile = getTileInTileset(rootTile.children[i], tileId);
      i++;
    }
  }
  return tile;
}

/**
 * Find the tile in the 3DTiles layer with the specifid ID.
 *
 * @param {*} layer The 3DTiles layer.
 * @param {number} tileId The tile id.
 * @returns {object} A 3DTiles tile object from THREE.js.
 */
export function getTileInLayer(layer, tileId) {
  const rootTile = layer.object3d.children[0];
  const tile = getTileInTileset(rootTile, tileId);
  return tile;
}

// #OBSOLETE
/**
 * Changes the color of a tile, or specific vertices of the tile, using the
 * BufferGeometry.
 *
 * @param {*} tile The 3DTiles tile object from THREE.js
 * @param {Array&lt;number>} newColor An array of RGB value between 0 and 1.
 * @param {Array&lt;number>} [indexArray] Optional. The indexes of vertices to
 * change the color. By default, all vertices has their color changed. The array
 * is assumed to be **sorted** and **contiguous**.
 */
export function setTileVerticesColor(tile, newColor, indexArray = null) {
  if (!tile) {
    throw 'Tile not loaded in view';
  }

  // Find the 'Mesh' part of the tile
  while (!!tile.children[0] &amp;&amp; !(tile.type === 'Mesh')) {
    tile = tile.children[0];
  }

  if (!tile.geometry.attributes._BATCHID) {
    throw 'Invalid tile';
  }

  if (tile.geometry.type !== 'BufferGeometry') {
    throw 'Cannot change vertices color';
  }

  // Create the new color array
  const indexCount = tile.geometry.attributes._BATCHID.count;
  const colors = new Float32Array(indexCount * 3);

  const lowerBound = indexArray[0];
  const upperBound = indexArray[indexArray.length - 1];
  for (let i = 0; i &lt; indexCount; i++) {
    let vertexColor = newColor;
    if (!!indexArray &amp;&amp; (lowerBound > i || upperBound &lt; i)) {
      // If i is not one of the selected indexes, we keep the previous color
      const previousColor = tile.geometry.attributes.color
        ? tile.geometry.attributes.color.array.slice(i * 3, i * 3 + 3)
        : tile.material.color.toArray();
      vertexColor = previousColor;
    }

    colors[i * 3] = vertexColor[0];
    colors[i * 3 + 1] = vertexColor[1];
    colors[i * 3 + 2] = vertexColor[2];
  }

  // We need to use the color of the vertices, not the material
  tile.material.vertexColors = true;

  if (!tile.geometry.attributes.color) {
    // If no vertex color is present, we need to add the BufferAttribute
    tile.geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
  } else {
    // Else we need to update the existing attribute
    tile.geometry.attributes.color.set(colors);
    tile.geometry.attributes.color.needsUpdate = true;
  }
}

/**
 * Creates tile groups and associate them with the given materials.
 *
 * @param {*} tile The 3DTiles tile.
 * @param {Array&lt;any>} materialsProps An array of material parameters. Each entry
 * should be an object that will be passed as parameter in the THREE.Material
 * constructor. Accepted values are for example `color` or `opacity`; actually
 * any property of the `MeshLambertMaterial` class is valid (see [THREE.js
 * documentation](https://threejs.org/docs/#api/en/materials/MeshLambertMaterial)).
 * @param {Array&lt;any>} ranges An array of ranges. A range is an object with 3
 * propeties :
 * - `start`: the start index of the group of vertices
 * - `count`: the number of vertices of the group
 * - `material`: the index of the material in the materials array
 * @example
 * // Fetch the tile
 * let tile = getTileInLayer(this.layer, 6);
 * // Define 2 materials : #0 is red and a bit transparent, #1 is invisible
 * let materialProps = [
 *   { color: 0xff0000, opacity: 0.8},
 *   { opacity: 0}
 * ];
 * // Define 3 ranges associated with the materials
 * let ranges = [
 *   { start: 34629, count: 102, material: 1 },
 *   { start: 34131, count: 174, material: 0 },
 *   { start: 34731, count: 462, material: 0 }
 * ];
 * createTileGroups(tile, materialProps, ranges);
 */
export function createTileGroups(tile, materialsProps, ranges) {
  const meshes = getMeshesFromTile(tile);

  for (const [index, mesh] of meshes.entries()) {
    const defaultMaterial = Array.isArray(mesh.material)
      ? mesh.material[0]
      : mesh.material;

    // Reset the materials
    mesh.material = [defaultMaterial];

    // Material index table (index in materialProps -> index in mesh.material)
    const materialIndexTable = {};

    // Create the materials
    for (
      let materialIndex = 0;
      materialIndex &lt; materialsProps.length;
      materialIndex++
    ) {
      const props = materialsProps[materialIndex];
      if (props.transparent === undefined) {
        props.transparent = true;
      }
      materialIndexTable[materialIndex] = mesh.material.length;
      mesh.material.push(new THREE.MeshStandardMaterial(props));
    }

    // Clear the existing groups
    mesh.geometry.groups = [];

    // Total of vertices in the tile
    const total = mesh.geometry.attributes._BATCHID.count;
    let meshRanges = ranges[index];

    if (meshRanges.length > 0) {
      // Sort the meshRanges by increasing start index
      meshRanges.sort((a, b) => {
        return a.start - b.start;
      });
      // Merge consecutive meshRanges with the same material
      const mergedRanges = [];
      for (let index = 0; index &lt; meshRanges.length; index++) {
        const range = meshRanges[index];
        if (index === 0) {
          mergedRanges.push(range);
        } else {
          const currentMergingRange = mergedRanges[mergedRanges.length - 1];
          if (
            currentMergingRange.start + currentMergingRange.count ===
              range.start &amp;&amp;
            currentMergingRange.material === range.material
          ) {
            currentMergingRange.count += range.count;
          } else {
            mergedRanges.push(range);
          }
        }
      }
      meshRanges = mergedRanges;

      // Add the new groups
      for (let rangeIndex = 0; rangeIndex &lt; meshRanges.length; rangeIndex++) {
        const range = meshRanges[rangeIndex];
        mesh.geometry.addGroup(
          range.start,
          range.count,
          materialIndexTable[range.material]
        );
      }

      // Fill the "blanks" between the meshRanges with the default material
      if (meshRanges[0].start > 0) {
        mesh.geometry.addGroup(0, meshRanges[0].start, 0);
      }
      for (let i = 0; i &lt; meshRanges.length - 1; ++i) {
        const start = meshRanges[i].start + meshRanges[i].count;
        const count = meshRanges[i + 1].start - start;
        if (count > 0) {
          mesh.geometry.addGroup(start, count, 0);
        }
      }
      if (
        meshRanges[meshRanges.length - 1].start +
          meshRanges[meshRanges.length - 1].count &lt;
        total
      ) {
        const start =
          meshRanges[meshRanges.length - 1].start +
          meshRanges[meshRanges.length - 1].count;
        mesh.geometry.addGroup(start, total - start, 0);
      }
    } else {
      // If no meshRanges array is specified, just add a group containing all vertices
      mesh.geometry.addGroup(0, total, 0);
    }
  }
}

/**
 * Create groups in the tile mesh from the given batch IDs and materials.
 *
 * @param {*} tile The 3DTiles tile.
 * @param {Array&lt;any>} groups An array of group descriptors. A group descriptor
 * is a dictionnary containing two entries :
 * - `material` contains the material parameters, such as `color` or `opacity`.
 * - `batchIDs` contains the batch IDs to be applied the given material.
 * @example
 * // Fetch the tile
 * let tile = getTileInLayer(layer, 6);
 * // Create groups for two types of objects : the first type has a red,
 * // transparent material. The second one is invisible.
 * createTileGroupsFromBatchIDs(tile, [
 *   {
 *     material: {color: 0xff0000, opacity: 0.8},
 *     batchIDs: [64, 67]
 *   },
 *   {
 *     material: {opacity: 0},
 *     batchIDs: [66]
 *   }
 * ]);
 */
export function createTileGroupsFromBatchIDs(tile, groups) {
  const materials = [];
  const ranges = [];

  const mesh = getMeshesFromTile(tile)[0];

  // Create an array we can loop on to search all batchIDs, plus a stucture
  // to associate batchIDs with their material
  const batchIDs = [];
  const materialIndexTable = {};
  for (let groupIndex = 0; groupIndex &lt; groups.length; groupIndex++) {
    const group = groups[groupIndex];

    // Check if a similar material has been added
    let materialIndex = materials.findIndex((mat) => {
      return Data.objectEquals(mat, group.material);
    });
    if (materialIndex &lt; 0) {
      // If the material is new, push it
      materialIndex = materials.length;
      materials.push(group.material);
    }

    // Push the batch IDs and remember their material
    for (
      let batchIDIndex = 0;
      batchIDIndex &lt; group.batchIDs.length;
      batchIDIndex++
    ) {
      const batchID = group.batchIDs[batchIDIndex];
      batchIDs.push(batchID);
      materialIndexTable[batchID] = materialIndex;
    }
  }

  // Sort the batch IDs
  batchIDs.sort((a, b) => {
    return a - b;
  });

  // We need to find the ranges of the various batch IDs
  let searchingIndex = 0;
  let searchingBatchID = batchIDs[searchingIndex];
  let addingRange = {
    material: materialIndexTable[searchingBatchID],
  };

  // Loop once over all vertices to find the ranges
  for (
    let index = 0, total = mesh.geometry.attributes._BATCHID.count;
    index &lt; total;
    index++
  ) {
    const batchID = mesh.geometry.attributes._BATCHID.array[index];

    // If we found a batch ID that is greater than the one we're searching, it
    // means we found the end of the range.
    if (batchID > searchingBatchID) {
      addingRange.count = index - addingRange.start;
      ranges.push(addingRange);

      if (searchingBatchID === undefined) {
        // No more batch IDs to search
        break;
      }

      searchingIndex += 1;
      searchingBatchID = batchIDs[searchingIndex];
      addingRange = {
        material: materialIndexTable[searchingBatchID],
      };
    }

    // If we find the correct batch ID, store the start index
    if (batchID === searchingBatchID &amp;&amp; !addingRange.start) {
      addingRange.start = index;
    }

    if (
      index === mesh.geometry.attributes._BATCHID.count - 1 &amp;&amp;
      !!addingRange.start &amp;&amp;
      !addingRange.count
    ) {
      addingRange.count = index - addingRange.start + 1;
      ranges.push(addingRange);
    }
  }

  // Create the tile groups
  createTileGroups(mesh, materials, ranges);
}

/**
 * Removes vertex-specific colors of the tile and switch back to the material's
 * color.
 *
 * @param {*} tile The 3DTiles tile.
 */
export function removeTileVerticesColor(tile) {
  if (!tile) {
    throw 'Tile not loaded in view';
  }

  // Find the 'Mesh' part of the tile
  while (!!tile.children[0] &amp;&amp; !(tile.type === 'Mesh')) {
    tile = tile.children[0];
  }

  if (!tile.geometry.attributes._BATCHID) {
    throw 'Invalid tile';
  }

  if (tile.geometry.type !== 'BufferGeometry') {
    throw 'Cannot change vertices color';
  }

  // Remove color attribute
  tile.geometry.deleteAttribute('color');

  // We go back to the color of the material
  tile.material.vertexColors = false;
}

/**
 * Tells the iTowns view to update the scene. If you made changes to some colors
 * for example, you need to call this function to actually see the changes.
 *
 * @param {*} view The iTowns view.
 * @param {*} layer An iTowns layer
 */
export function updateITownsView(view, layer) {
  try {
    view.mainLoop.gfxEngine.renderViewToBuffer(
      {
        scene: layer.object3d,
        camera: view.camera,
      },
      { x: 0, y: 0, width: 0, height: 0 }
    );
    view.notifyChange();
  } catch (e) {
    console.error(e);
  }
}

/**
 * Computes and returns the centroid of the vertices given as parameter.
 *
 * @param {*} tile The 3DTiles tile.
 * @param {*} indexArray The indexes of the vertices. It is assumed to be
 * **sorted** and **contiguous**.
 * @returns {THREE.Vector3} The centroid of the vertices.
 */
export function getVerticesCentroid(tile, indexArray) {
  if (!tile) {
    throw 'Tile not loaded in view';
  }

  // Find the 'Mesh' part of the tile
  while (!!tile.children[0] &amp;&amp; !(tile.type === 'Mesh')) {
    tile = tile.children[0];
  }

  if (!tile.geometry.attributes._BATCHID) {
    throw 'Invalid tile';
  }

  if (tile.geometry.type !== 'BufferGeometry') {
    throw 'Cannot change vertices color';
  }

  const vertexSum = new THREE.Vector3(0, 0, 0);
  const positionArray = tile.geometry.attributes.position.array;
  for (let i = indexArray[0]; i &lt;= indexArray[indexArray.length - 1]; ++i) {
    vertexSum.x += positionArray[i * 3];
    vertexSum.y += positionArray[i * 3 + 1];
    vertexSum.z += positionArray[i * 3 + 2];
  }
  const vertexCount = indexArray.length;
  const vertexCentroid = vertexSum
    .divideScalar(vertexCount)
    .applyMatrix4(tile.matrixWorld);
  return vertexCentroid;
}

/**
 * Returns all the THREE.js meshes in the tile
 *
 * @param {object} tile A 3DTiles tile object from THREE.js.
 * @returns {Array&lt;THREE.Mesh>} An array of the THREE.js meshes in the tile
 */
export function getMeshesFromTile(tile) {
  if (!tile) {
    throw 'Tile not loaded in view';
  }

  // Find the 'Mesh' part of the tile
  while (!!tile.children[0] &amp;&amp; !(tile.children[0].type === 'Mesh')) {
    tile = tile.children[0];
  }

  for (const mesh of tile.children) {
    if (!mesh.geometry.attributes._BATCHID) {
      throw 'Invalid tile';
    }
    if (mesh.geometry.type !== 'BufferGeometry') {
      throw 'Tile has no buffer geometry';
    }
  }

  return tile.children;
}

/**
 * Returns the tile in which a mesh is contained
 *
 * @param {THREE.mesh} object A THREE.js mesh
 * @returns {object} A 3DTiles tile object from THREE.js.
 */
export function getTileFromMesh(object) {
  if (!object) {
    throw 'Object not loaded in view';
  }

  // Find the 'Object3D' part of the tile
  while (!!object.parent &amp;&amp; !(object.type === 'Object3D')) {
    object = object.parent;
  }

  if (!object.batchTable) {
    throw 'Invalid tile : no batch table';
  }

  return object;
}

/**
 * Creates a Tiles Info (TI) object from a 3DTiles Layer.
 * The TI is an object containing associations between tile, batch IDs and
 * data specific to the batched geometry (vertex indexes, centroid, properties
 * from the batch table).
 *
 * @param {*} layer The 3DTiles layer.
 * @param {*} tilesInfo An existing TI for this layer. Tiles that are currently
 * loaded in the layer will be added to the TI if they're not already present.
 * If no TI is provided, a brand new one will be instantiated with currently
 * loaded tiles.
 * @example
 * let layer = view.getLayerById(config['3DTilesLayerID']);
 * //Fetch the TI
 * let tilesInfo = getTilesBatchInfo(layer);
 * // Get intersections from mouse position
 * let intersections = view.pickObjectsAt(mouseEvent, 5);
 * // Get the first intersecting tile
 * let firstInter = getFirstTileIntersection(intersections);
 * // Retrieve the object's ID
 * let tileId = getObject3DFromTile(firstInter.object).tileId;
 * let batchId = getBatchIdFromIntersection(firstInter);
 * //Display the building's infos
 * console.log(tilesInfo.tiles[tileId][batchId]);
 * @example
 * let layer = view.getLayerById(config['3DTilesLayerID']);
 * //Initialize the TI
 * let tilesInfo = getTilesBatchInfo(layer);
 * //When the visible tiles change, update the TI
 * tilesInfo = getTilesBatchInfo(layer, tilesInfo);
 * @returns {object} An object holding the information of a tile
 */
export function getTilesInfo(layer, tilesInfo = null) {
  // Instantiate the TI if it does not exist
  if (!tilesInfo) {
    tilesInfo = {};
    tilesInfo.totalTileCount = 0;
    tilesInfo.loadedTileCount = 0;
    tilesInfo.tiles = {};
    tilesInfo.tileset;
  }
  const tileset = layer.tileset;
  const tileCount = tileset.tiles.length;
  tilesInfo.totalTileCount = tileCount;
  const rootTile = layer.object3d.children[0];
  tilesInfo.tileset = rootTile;
  const tiles = getVisibleTiles(layer);
  // Tiles contains every tile currently loaded in the scene. We iterate
  // over them to visit the ones that we have not visited yet.
  for (const tile of tiles) {
    const tileId = tile.tileId;
    // Check if this tile is already loaded (visited) in the TI
    if (!tilesInfo.tiles[tileId]) {
      const batchTable = tile.batchTable;
      const attributes = tile.children[0].children[0].geometry.attributes;

      // Map batchId -> object info
      tilesInfo.tiles[tileId] = {};

      const newbatchIds = [];
      // For each vertex get the corresponding batch ID
      attributes._BATCHID.array.forEach((batchId, arrayIndex) => {
        // Creates a dict entry for the batch ID
        if (!tilesInfo.tiles[tileId][batchId]) {
          tilesInfo.tiles[tileId][batchId] = {};
          tilesInfo.tiles[tileId][batchId].arrayIndexes = [];
          tilesInfo.tiles[tileId][batchId].tileId = tile.tileId;
          tilesInfo.tiles[tileId][batchId].batchId = batchId;
          tilesInfo.tiles[tileId][batchId].centroid = null;
          tilesInfo.tiles[tileId][batchId].props = {};

          for (const key of Object.keys(batchTable.content)) {
            tilesInfo.tiles[tileId][batchId].props[key] =
              batchTable.content[key][batchId];
          }

          newbatchIds.push(batchId);
        }
        // Associates the vertex to the corresponding building ID
        tilesInfo.tiles[tileId][batchId].arrayIndexes.push(arrayIndex);
      });
      // For each newly added building, compute the centroid
      for (const batchId of newbatchIds) {
        tilesInfo.tiles[tileId][batchId].centroid = getVerticesCentroid(
          tile,
          tilesInfo.tiles[tileId][batchId].arrayIndexes
        );
      }
      tilesInfo.loadedTileCount += 1;
    }
  }
  return tilesInfo;
}
</code></pre></article></section><footer class="footer" id="PeOAagUepe"><div class="wrapper">Fork: <a href="https://github.com/VCityTeam/UD-Viz">https://github.com/VCityTeam/UD-Viz</a></div></footer></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz/browser</a><div class="mobile-nav-links"><div class="navbar-item"><a id="Github-mobile" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples-mobile" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome-mobile" href="../" target="">udviz</a></div><div class="navbar-item"><a id="udvizBrowser-mobile" href="../browser" target="">udvizBrowser</a></div><div class="navbar-item"><a id="udvizShared-mobile" href="../shared" target="">udvizShared</a></div><div class="navbar-item"><a id="udvizNode-mobile" href="../node" target="">udvizNode</a></div></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="mra33q2MTNxKVtoe6vYlU"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="$3DTemporalBatchTable.html">$3DTemporalBatchTable</a></div><div class="sidebar-section-children"><a href="$3DTemporalBoundingVolume.html">$3DTemporalBoundingVolume</a></div><div class="sidebar-section-children"><a href="$3DTemporalExtension.html">$3DTemporalExtension</a></div><div class="sidebar-section-children"><a href="$3DTemporalPrimaryTransaction.html">$3DTemporalPrimaryTransaction</a></div><div class="sidebar-section-children"><a href="$3DTemporalTileset.html">$3DTemporalTileset</a></div><div class="sidebar-section-children"><a href="$3DTemporalTransaction.html">$3DTemporalTransaction</a></div><div class="sidebar-section-children"><a href="$3DTemporalTransactionAggregate.html">$3DTemporalTransactionAggregate</a></div><div class="sidebar-section-children"><a href="$3DTemporalVersion.html">$3DTemporalVersion</a></div><div class="sidebar-section-children"><a href="AboutWindow.html">AboutWindow</a></div><div class="sidebar-section-children"><a href="AbstractDocumentWindow.html">AbstractDocumentWindow</a></div><div class="sidebar-section-children"><a href="AllWidget.html">AllWidget</a></div><div class="sidebar-section-children"><a href="AssetManager.html">AssetManager</a></div><div class="sidebar-section-children"><a href="AttributeFilter.html">AttributeFilter</a></div><div class="sidebar-section-children"><a href="AttributeFilterSelector.html">AttributeFilterSelector</a></div><div class="sidebar-section-children"><a href="AudioController.html">AudioController</a></div><div class="sidebar-section-children"><a href="AuthenticationView.html">AuthenticationView</a></div><div class="sidebar-section-children"><a href="BaseMap.html">BaseMap</a></div><div class="sidebar-section-children"><a href="Billboard.html">Billboard</a></div><div class="sidebar-section-children"><a href="CameraPositionerView.html">CameraPositionerView</a></div><div class="sidebar-section-children"><a href="Cameraman.html">Cameraman</a></div><div class="sidebar-section-children"><a href="CityObject.html">CityObject</a></div><div class="sidebar-section-children"><a href="CityObjectFilter.html">CityObjectFilter</a></div><div class="sidebar-section-children"><a href="CityObjectFilterSelector.html">CityObjectFilterSelector</a></div><div class="sidebar-section-children"><a href="CityObjectFilterWindow.html">CityObjectFilterWindow</a></div><div class="sidebar-section-children"><a href="CityObjectID.html">CityObjectID</a></div><div class="sidebar-section-children"><a href="CityObjectLayer.html">CityObjectLayer</a></div><div class="sidebar-section-children"><a href="CityObjectLinkInterface.html">CityObjectLinkInterface</a></div><div class="sidebar-section-children"><a href="CityObjectModule.html">CityObjectModule</a></div><div class="sidebar-section-children"><a href="CityObjectProvider.html">CityObjectProvider</a></div><div class="sidebar-section-children"><a href="CityObjectStyle.html">CityObjectStyle</a></div><div class="sidebar-section-children"><a href="CityObjectWindow.html">CityObjectWindow</a></div><div class="sidebar-section-children"><a href="CommandController.html">CommandController</a></div><div class="sidebar-section-children"><a href="Context.html">Context</a></div><div class="sidebar-section-children"><a href="ContributeModule.html">ContributeModule</a></div><div class="sidebar-section-children"><a href="ContributeService.html">ContributeService</a></div><div class="sidebar-section-children"><a href="Debug3DTilesWindow.html">Debug3DTilesWindow</a></div><div class="sidebar-section-children"><a href="DefaultDocumentSource.html">DefaultDocumentSource</a></div><div class="sidebar-section-children"><a href="Document.html">Document</a></div><div class="sidebar-section-children"><a href="DocumentCommentsModule.html">DocumentCommentsModule</a></div><div class="sidebar-section-children"><a href="DocumentCommentsService.html">DocumentCommentsService</a></div><div class="sidebar-section-children"><a href="DocumentCommentsWindow.html">DocumentCommentsWindow</a></div><div class="sidebar-section-children"><a href="DocumentCreationWindow.html">DocumentCreationWindow</a></div><div class="sidebar-section-children"><a href="DocumentDeletionInterface.html">DocumentDeletionInterface</a></div><div class="sidebar-section-children"><a href="DocumentFilter.html">DocumentFilter</a></div><div class="sidebar-section-children"><a href="DocumentInspectorWindow.html">DocumentInspectorWindow</a></div><div class="sidebar-section-children"><a href="DocumentLinkInterface.html">DocumentLinkInterface</a></div><div class="sidebar-section-children"><a href="DocumentModule.html">DocumentModule</a></div><div class="sidebar-section-children"><a href="DocumentNavigatorWindow.html">DocumentNavigatorWindow</a></div><div class="sidebar-section-children"><a href="DocumentProvider.html">DocumentProvider</a></div><div class="sidebar-section-children"><a href="DocumentSearchFilter.html">DocumentSearchFilter</a></div><div class="sidebar-section-children"><a href="DocumentService.html">DocumentService</a></div><div class="sidebar-section-children"><a href="DocumentSource.html">DocumentSource</a></div><div class="sidebar-section-children"><a href="DocumentUpdateWindow.html">DocumentUpdateWindow</a></div><div class="sidebar-section-children"><a href="DocumentValidationModule.html">DocumentValidationModule</a></div><div class="sidebar-section-children"><a href="DocumentView.html">DocumentView</a></div><div class="sidebar-section-children"><a href="DocumentVisualizerWindow.html">DocumentVisualizerWindow</a></div><div class="sidebar-section-children"><a href="DocumentsInValidationDocumentSource.html">DocumentsInValidationDocumentSource</a></div><div class="sidebar-section-children"><a href="DragAndDropAvatar.html">DragAndDropAvatar</a></div><div class="sidebar-section-children"><a href="ExternalScriptBase_ExternalScriptBase.html">ExternalScriptBase</a></div><div class="sidebar-section-children"><a href="FocusGameObject_FocusGameObject.html">FocusGameObject</a></div><div class="sidebar-section-children"><a href="Frame3DBase.html">Frame3DBase</a></div><div class="sidebar-section-children"><a href="Frame3DPlanar.html">Frame3DPlanar</a></div><div class="sidebar-section-children"><a href="GeocodingService_GeocodingService.html">GeocodingService</a></div><div class="sidebar-section-children"><a href="GeocodingView_GeocodingView.html">GeocodingView</a></div><div class="sidebar-section-children"><a href="Graph_Graph.html">Graph</a></div><div class="sidebar-section-children"><a href="GuidedTour.html">GuidedTour</a></div><div class="sidebar-section-children"><a href="GuidedTourController.html">GuidedTourController</a></div><div class="sidebar-section-children"><a href="HelpWindow.html">HelpWindow</a></div><div class="sidebar-section-children"><a href="InputManager.html">InputManager</a></div><div class="sidebar-section-children"><a href="LayerChoice_LayerChoice.html">LayerChoice</a></div><div class="sidebar-section-children"><a href="LayerManager.html">LayerManager</a></div><div class="sidebar-section-children"><a href="Link.html">Link</a></div><div class="sidebar-section-children"><a href="LinkCountFilter.html">LinkCountFilter</a></div><div class="sidebar-section-children"><a href="LinkCountFilterSelector.html">LinkCountFilterSelector</a></div><div class="sidebar-section-children"><a href="LinkModule.html">LinkModule</a></div><div class="sidebar-section-children"><a href="LinkProvider.html">LinkProvider</a></div><div class="sidebar-section-children"><a href="LinkService.html">LinkService</a></div><div class="sidebar-section-children"><a href="LinkView.html">LinkView</a></div><div class="sidebar-section-children"><a href="LinkedWithDisplayedDocumentFilter.html">LinkedWithDisplayedDocumentFilter</a></div><div class="sidebar-section-children"><a href="LinkedWithFilteredDocumentsFilter.html">LinkedWithFilteredDocumentsFilter</a></div><div class="sidebar-section-children"><a href="LoadingView.html">LoadingView</a></div><div class="sidebar-section-children"><a href="MouseState.html">MouseState</a></div><div class="sidebar-section-children"><a href="NetworkManager.html">NetworkManager</a></div><div class="sidebar-section-children"><a href="PositionerWindow_PositionerWindow.html">PositionerWindow</a></div><div class="sidebar-section-children"><a href="RenderController_RenderController.html">RenderController</a></div><div class="sidebar-section-children"><a href="RenderData.html">RenderData</a></div><div class="sidebar-section-children"><a href="RequestAnimationFrameProcess_RequestAnimationFrameProcess.html">RequestAnimationFrameProcess</a></div><div class="sidebar-section-children"><a href="SinglePlayerGamePlanar.html">SinglePlayerGamePlanar</a></div><div class="sidebar-section-children"><a href="SlideShow.html">SlideShow</a></div><div class="sidebar-section-children"><a href="SocketIOWrapper.html">SocketIOWrapper</a></div><div class="sidebar-section-children"><a href="SparqlEndpointResponseProvider.html">SparqlEndpointResponseProvider</a></div><div class="sidebar-section-children"><a href="SparqlEndpointService.html">SparqlEndpointService</a></div><div class="sidebar-section-children"><a href="SparqlModule.html">SparqlModule</a></div><div class="sidebar-section-children"><a href="SparqlModuleView.html">SparqlModuleView</a></div><div class="sidebar-section-children"><a href="SparqlQueryWindow.html">SparqlQueryWindow</a></div><div class="sidebar-section-children"><a href="StyleManager.html">StyleManager</a></div><div class="sidebar-section-children"><a href="Table.html">Table</a></div><div class="sidebar-section-children"><a href="Target.html">Target</a></div><div class="sidebar-section-children"><a href="TemporalGraphWindow.html">TemporalGraphWindow</a></div><div class="sidebar-section-children"><a href="TemporalModule.html">TemporalModule</a></div><div class="sidebar-section-children"><a href="TemporalProvider.html">TemporalProvider</a></div><div class="sidebar-section-children"><a href="TemporalSliderWindow.html">TemporalSliderWindow</a></div><div class="sidebar-section-children"><a href="TemporalView.html">TemporalView</a></div><div class="sidebar-section-children"><a href="Tile.html">Tile</a></div><div class="sidebar-section-children"><a href="TilesManager.html">TilesManager</a></div><div class="sidebar-section-children"><a href="UpdateZWithElevationLayer.html">UpdateZWithElevationLayer</a></div><div class="sidebar-section-children"><a href="ValidationService.html">ValidationService</a></div><div class="sidebar-section-children"><a href="ValidationView.html">ValidationView</a></div><div class="sidebar-section-children"><a href="WidgetView.html">WidgetView</a></div><div class="sidebar-section-children"><a href="Window.html">Window</a></div><div class="sidebar-section-children"><a href="WindowExtension.html">WindowExtension</a></div><div class="sidebar-section-children"><a href="WindowManager.html">WindowManager</a></div><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns-LayerManager.html">LayerManager</a></div><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns-TilesManager.html">TilesManager</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="FXtr-pzjZBi459ISR9sj4"><div>Modules</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns.html">udvizBrowser/Itowns</a></div><div class="sidebar-section-children"><a href="module-udvizBrowser_Itowns_Component.html">udvizBrowser/Itowns/Component</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="JEdFyHWj1SpU-rjP2EmJ7"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-ArchitectureMVCTargetDesign.html">ArchitectureMVCTargetDesign</a></div><div class="sidebar-section-children"><a href="tutorial-Configuring-the-Document-model-of-an-UDV-deployment.html">Configuring-the-Document-model-of-an-UDV-deployment</a></div><div class="sidebar-section-children"><a href="tutorial-Contributing.html">Contributing</a></div><div class="sidebar-section-children"><a href="tutorial-Definitions.html">Definitions</a></div><div class="sidebar-section-children"><a href="tutorial-LocalGameTutorial.html">LocalGameTutorial</a></div><div class="sidebar-section-children"><a href="tutorial-ReleasePublish.html">ReleasePublish</a></div><div class="sidebar-section-children"><a href="tutorial-Reproducibility.html">Reproducibility</a></div><div class="sidebar-section-children"><a href="tutorial-View3D.html">View3D</a></div><div class="sidebar-section-children"><a href="tutorial-ContributeData.html">ContributeData</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="1yjpUHdYQvZgcGLsARdOE"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#ActionCB">ActionCB</a></div><div class="sidebar-section-children"><a href="global.html#AssetManagerConfig">AssetManagerConfig</a></div><div class="sidebar-section-children"><a href="global.html#AuthenticationService">AuthenticationService</a></div><div class="sidebar-section-children"><a href="global.html#BLANK_MATERIAL">BLANK_MATERIAL</a></div><div class="sidebar-section-children"><a href="global.html#CommandCallback">CommandCallback</a></div><div class="sidebar-section-children"><a href="global.html#DEFAULT_MATERIAL">DEFAULT_MATERIAL</a></div><div class="sidebar-section-children"><a href="global.html#DocumentInspectorExtension">DocumentInspectorExtension</a></div><div class="sidebar-section-children"><a href="global.html#DocumentNavigatorExtension">DocumentNavigatorExtension</a></div><div class="sidebar-section-children"><a href="global.html#DragAndDropAvatarVariables">DragAndDropAvatarVariables</a></div><div class="sidebar-section-children"><a href="global.html#EventCallback">EventCallback</a></div><div class="sidebar-section-children"><a href="global.html#FileReaderCallback">FileReaderCallback</a></div><div class="sidebar-section-children"><a href="global.html#FilterCityObjects">FilterCityObjects</a></div><div class="sidebar-section-children"><a href="global.html#FocusGameObjectVariables">FocusGameObjectVariables</a></div><div class="sidebar-section-children"><a href="global.html#Frame3DPlanarOption">Frame3DPlanarOption</a></div><div class="sidebar-section-children"><a href="global.html#MAPPING">MAPPING</a></div><div class="sidebar-section-children"><a href="global.html#MOUSE_STATE_EVENTS">MOUSE_STATE_EVENTS</a></div><div class="sidebar-section-children"><a href="global.html#Mapping">Mapping</a></div><div class="sidebar-section-children"><a href="global.html#Movement">Movement</a></div><div class="sidebar-section-children"><a href="global.html#OptionsRenderJSON">OptionsRenderJSON</a></div><div class="sidebar-section-children"><a href="global.html#RenderDataConfig">RenderDataConfig</a></div><div class="sidebar-section-children"><a href="global.html#RequestService">RequestService</a></div><div class="sidebar-section-children"><a href="global.html#SceneConfig">SceneConfig</a></div><div class="sidebar-section-children"><a href="global.html#SoundsConfig">SoundsConfig</a></div><div class="sidebar-section-children"><a href="global.html#TemporalOptions">TemporalOptions</a></div><div class="sidebar-section-children"><a href="global.html#TextureFile">TextureFile</a></div><div class="sidebar-section-children"><a href="global.html#UpdateZWithElevationLayerVariables">UpdateZWithElevationLayerVariables</a></div><div class="sidebar-section-children"><a href="global.html#add3DTilesLayers">add3DTilesLayers</a></div><div class="sidebar-section-children"><a href="global.html#addBaseMapLayer">addBaseMapLayer</a></div><div class="sidebar-section-children"><a href="global.html#addElevationLayer">addElevationLayer</a></div><div class="sidebar-section-children"><a href="global.html#addGeoJsonLayers">addGeoJsonLayers</a></div><div class="sidebar-section-children"><a href="global.html#cbAccepts">cbAccepts</a></div><div class="sidebar-section-children"><a href="global.html#cbAction">cbAction</a></div><div class="sidebar-section-children"><a href="global.html#cbInspectorOptionsExtension">cbInspectorOptionsExtension</a></div><div class="sidebar-section-children"><a href="global.html#cbMouseEvent">cbMouseEvent</a></div><div class="sidebar-section-children"><a href="global.html#cbNavigatorOptionsExtension">cbNavigatorOptionsExtension</a></div><div class="sidebar-section-children"><a href="global.html#cbSocketIO">cbSocketIO</a></div><div class="sidebar-section-children"><a href="global.html#cbTickAnimationFrame">cbTickAnimationFrame</a></div><div class="sidebar-section-children"><a href="global.html#checkParentChild">checkParentChild</a></div><div class="sidebar-section-children"><a href="global.html#colorBuilding">colorBuilding</a></div><div class="sidebar-section-children"><a href="global.html#computeRelativeElevationFromGround">computeRelativeElevationFromGround</a></div><div class="sidebar-section-children"><a href="global.html#createCityObjectID">createCityObjectID</a></div><div class="sidebar-section-children"><a href="global.html#createTileGroups">createTileGroups</a></div><div class="sidebar-section-children"><a href="global.html#createTileGroupsFromBatchIDs">createTileGroupsFromBatchIDs</a></div><div class="sidebar-section-children"><a href="global.html#defaultConfigScene">defaultConfigScene</a></div><div class="sidebar-section-children"><a href="global.html#defaultVariables">defaultVariables</a></div><div class="sidebar-section-children"><a href="global.html#defaultVariables">defaultVariables</a></div><div class="sidebar-section-children"><a href="global.html#defaultVariables">defaultVariables</a></div><div class="sidebar-section-children"><a href="global.html#dragElement">dragElement</a></div><div class="sidebar-section-children"><a href="global.html#getBatchIdFromIntersection">getBatchIdFromIntersection</a></div><div class="sidebar-section-children"><a href="global.html#getBatchTableFromTile">getBatchTableFromTile</a></div><div class="sidebar-section-children"><a href="global.html#getBuildingIdFromIntersection">getBuildingIdFromIntersection</a></div><div class="sidebar-section-children"><a href="global.html#getBuildingInfoFromBuildingId">getBuildingInfoFromBuildingId</a></div><div class="sidebar-section-children"><a href="global.html#getFirstTileIntersection">getFirstTileIntersection</a></div><div class="sidebar-section-children"><a href="global.html#getMeshesFromTile">getMeshesFromTile</a></div><div class="sidebar-section-children"><a href="global.html#getTileFromMesh">getTileFromMesh</a></div><div class="sidebar-section-children"><a href="global.html#getTileInLayer">getTileInLayer</a></div><div class="sidebar-section-children"><a href="global.html#getTileInTileset">getTileInTileset</a></div><div class="sidebar-section-children"><a href="global.html#getTilesInfo">getTilesInfo</a></div><div class="sidebar-section-children"><a href="global.html#getVerticesCentroid">getVerticesCentroid</a></div><div class="sidebar-section-children"><a href="global.html#getVisibleTileCount">getVisibleTileCount</a></div><div class="sidebar-section-children"><a href="global.html#getVisibleTiles">getVisibleTiles</a></div><div class="sidebar-section-children"><a href="global.html#predicateCB">predicateCB</a></div><div class="sidebar-section-children"><a href="global.html#removeTileVerticesColor">removeTileVerticesColor</a></div><div class="sidebar-section-children"><a href="global.html#setTileVerticesColor">setTileVerticesColor</a></div><div class="sidebar-section-children"><a href="global.html#setup3DTilesLayer">setup3DTilesLayer</a></div><div class="sidebar-section-children"><a href="global.html#tokenizeURI">tokenizeURI</a></div><div class="sidebar-section-children"><a href="global.html#updateITownsView">updateITownsView</a></div><div class="sidebar-section-children"><a href="global.html#windows">windows</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>